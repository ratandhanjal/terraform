name: Azure Login via Federated Identity

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: self-hosted
    environment: Azureportal
    permissions:
      id-token: write  # Required for OIDC
      contents: read

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Azure Login
      uses: azure/login@v1
      with:
        client-id: ${{ vars.CLIENTID }}
        tenant-id: ${{ vars.TENANTID }}
        subscription-id: ${{ vars.SUBSCRIPTIONID }}
    
    - name: rg list
      run:
          echo "Listing resource groups in subscription..."
          az group list --output table
    
    