name: Azure Login via Federated Identity

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment: Azureportal
    permissions:
      id-token: write  # Required for OIDC
      contents: read

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Azure Login
      uses: azure/login@v1
      with:
        client-id: ${{ vars.CLIENTID }}
        tenant-id: ${{ vars.TENANTID }}
        subscription-id: ${{ vars.SUBSCRIPTIONID }}
    
    # - name: Enable PowerShell scripts (Windows only)
    #   run: Set-ExecutionPolicy RemoteSigned -Scope Process -Force
    #   shell: pwsh
    
    - name: List Resource Groups
      run: az group list --output table
      # shell: pwsh
      
    
    